package com.mayroro.controllers;

import java.util.List;

import com.google.gson.Gson;
import com.mayroro.util.ColumnDescription;
import com.mayroro.util.DataTable;
import com.mayroro.util.TableCell;
import com.mayroro.util.TableRow;
import com.mayroro.util.tree.*;

public class TestController {
	private static String drevo = "{\"cols\":[{\"id\":\"A\",\"label\":\"child\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"B\",\"label\":\"parent\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"C\",\"label\":\"\",\"type\":\"string\",\"pattern\":\"\"}],\"rows\":[{\"c\":[{\"v\":\"majer\"},{\"v\":\"mama\"},{\"v\":\"0.4\"}]},{\"c\":[{\"v\":\"mama\"},{\"v\":\"doer\"},{\"v\":\"0.2\"}]},{\"c\":[{\"v\":\"gad\"},{\"v\":\"mama\"},{\"v\":\"0.3\"}]},{\"c\":[{\"v\":\"roro\"},{\"v\":\"mama\"},{\"v\":\"0.34\"}]},{\"c\":[{\"v\":\"num\"},{\"v\":\"doer\"},{\"v\":\"0.23\"}]},{\"c\":[{\"v\":\"doer\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]},{\"c\":[{\"v\":\"\"},{\"v\":\"\"},{\"v\":\"\"}]}],\"p\":null}";
	private static String funkcije = "{\"cols\":[{\"id\":\"A\",\"label\":\"majer\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"},{\"id\":\"B\",\"label\":\"\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"},{\"id\":\"C\",\"label\":\"gad\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"},{\"id\":\"D\",\"label\":\"\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"},{\"id\":\"A\",\"label\":\"roro\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"},{\"id\":\"B\",\"label\":\"\",\"type\":\"number\",\"pattern\":\"#,##0.###############\"}],\"rows\":[{\"c\":[{\"v\":10,\"f\":\"10\"},{\"v\":100,\"f\":\"100\"},{\"v\":20,\"f\":\"20\"},{\"v\":30,\"f\":\"30\"},{\"v\":20,\"f\":\"20\"},{\"v\":30,\"f\":\"30\"}]},{\"c\":[{\"v\":1,\"f\":\"1\"},{\"v\":1,\"f\":\"1\"},{\"v\":1,\"f\":\"1\"},{\"v\":1,\"f\":\"1\"},{\"v\":1,\"f\":\"1\"},{\"v\":1,\"f\":\"1\"}]},{\"c\":[{\"v\":2,\"f\":\"2\"},{\"v\":0.8,\"f\":\"0,8\"},{\"v\":2,\"f\":\"2\"},{\"v\":0.8,\"f\":\"0,8\"},{\"v\":2,\"f\":\"2\"},{\"v\":0.8,\"f\":\"0,8\"}]},{\"c\":[{\"v\":3,\"f\":\"3\"},{\"v\":0.65,\"f\":\"0,65\"},{\"v\":3,\"f\":\"3\"},{\"v\":0.65,\"f\":\"0,65\"},{\"v\":3,\"f\":\"3\"},{\"v\":0.65,\"f\":\"0,65\"}]},{\"c\":[{\"v\":4,\"f\":\"4\"},{\"v\":0.57,\"f\":\"0,57\"},{\"v\":4,\"f\":\"4\"},{\"v\":0.57,\"f\":\"0,57\"},{\"v\":4,\"f\":\"4\"},{\"v\":0.57,\"f\":\"0,57\"}]},{\"c\":[{\"v\":5,\"f\":\"5\"},{\"v\":0.45,\"f\":\"0,45\"},{\"v\":5,\"f\":\"5\"},{\"v\":0.45,\"f\":\"0,45\"},{\"v\":5,\"f\":\"5\"},{\"v\":0.45,\"f\":\"0,45\"}]},{\"c\":[{\"v\":6,\"f\":\"6\"},{\"v\":0.39,\"f\":\"0,39\"},{\"v\":6,\"f\":\"6\"},{\"v\":0.39,\"f\":\"0,39\"},{\"v\":6,\"f\":\"6\"},{\"v\":0.39,\"f\":\"0,39\"}]},{\"c\":[{\"v\":7,\"f\":\"7\"},{\"v\":0.33,\"f\":\"0,33\"},{\"v\":7,\"f\":\"7\"},{\"v\":0.33,\"f\":\"0,33\"},{\"v\":7,\"f\":\"7\"},{\"v\":0.33,\"f\":\"0,33\"}]},{\"c\":[{\"v\":8,\"f\":\"8\"},{\"v\":0.29,\"f\":\"0,29\"},{\"v\":8,\"f\":\"8\"},{\"v\":0.29,\"f\":\"0,29\"},{\"v\":8,\"f\":\"8\"},{\"v\":0.29,\"f\":\"0,29\"}]},{\"c\":[{\"v\":9,\"f\":\"9\"},{\"v\":0.15,\"f\":\"0,15\"},{\"v\":9,\"f\":\"9\"},{\"v\":0.15,\"f\":\"0,15\"},{\"v\":9,\"f\":\"9\"},{\"v\":0.15,\"f\":\"0,15\"}]},{\"c\":[{\"v\":10,\"f\":\"10\"},{\"v\":0.7,\"f\":\"0,7\"},{\"v\":10,\"f\":\"10\"},{\"v\":0.7,\"f\":\"0,7\"},{\"v\":10,\"f\":\"10\"},{\"v\":0.7,\"f\":\"0,7\"}]},{\"c\":[{\"v\":11,\"f\":\"11\"},{\"v\":1,\"f\":\"1\"},{\"v\":11,\"f\":\"11\"},{\"v\":1,\"f\":\"1\"},{\"v\":11,\"f\":\"11\"},{\"v\":1,\"f\":\"1\"}]},{\"c\":[{\"v\":12,\"f\":\"12\"},{\"v\":0.8,\"f\":\"0,8\"},{\"v\":12,\"f\":\"12\"},{\"v\":0.8,\"f\":\"0,8\"},{\"v\":12,\"f\":\"12\"},{\"v\":0.8,\"f\":\"0,8\"}]},{\"c\":[{\"v\":13,\"f\":\"13\"},{\"v\":0.65,\"f\":\"0,65\"},{\"v\":13,\"f\":\"13\"},{\"v\":0.65,\"f\":\"0,65\"},{\"v\":13,\"f\":\"13\"},{\"v\":0.65,\"f\":\"0,65\"}]},{\"c\":[{\"v\":14,\"f\":\"14\"},{\"v\":0.57,\"f\":\"0,57\"},{\"v\":14,\"f\":\"14\"},{\"v\":0.57,\"f\":\"0,57\"},{\"v\":14,\"f\":\"14\"},{\"v\":0.57,\"f\":\"0,57\"}]},{\"c\":[{\"v\":15,\"f\":\"15\"},{\"v\":0.45,\"f\":\"0,45\"},{\"v\":15,\"f\":\"15\"},{\"v\":0.45,\"f\":\"0,45\"},{\"v\":15,\"f\":\"15\"},{\"v\":0.45,\"f\":\"0,45\"}]},{\"c\":[{\"v\":16,\"f\":\"16\"},{\"v\":0.39,\"f\":\"0,39\"},{\"v\":16,\"f\":\"16\"},{\"v\":0.39,\"f\":\"0,39\"},{\"v\":16,\"f\":\"16\"},{\"v\":0.39,\"f\":\"0,39\"}]},{\"c\":[{\"v\":17,\"f\":\"17\"},{\"v\":0.33,\"f\":\"0,33\"},{\"v\":17,\"f\":\"17\"},{\"v\":0.33,\"f\":\"0,33\"},{\"v\":17,\"f\":\"17\"},{\"v\":0.33,\"f\":\"0,33\"}]},{\"c\":[{\"v\":18,\"f\":\"18\"},{\"v\":0.29,\"f\":\"0,29\"},{\"v\":18,\"f\":\"18\"},{\"v\":0.29,\"f\":\"0,29\"},{\"v\":18,\"f\":\"18\"},{\"v\":0.29,\"f\":\"0,29\"}]},{\"c\":[{\"v\":19,\"f\":\"19\"},{\"v\":0.15,\"f\":\"0,15\"},{\"v\":19,\"f\":\"19\"},{\"v\":0.15,\"f\":\"0,15\"},{\"v\":19,\"f\":\"19\"},{\"v\":0.15,\"f\":\"0,15\"}]},{\"c\":[{\"v\":20,\"f\":\"20\"},{\"v\":0.7,\"f\":\"0,7\"},{\"v\":20,\"f\":\"20\"},{\"v\":0.7,\"f\":\"0,7\"},{\"v\":20,\"f\":\"20\"},{\"v\":0.7,\"f\":\"0,7\"}]}],\"p\":null}";
	private static String maut = "{\"cols\":[{\"id\":\"A\",\"label\":\"atribut\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"B\",\"label\":\"bmw\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"C\",\"label\":\"vw\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"D\",\"label\":\"ford\",\"type\":\"string\",\"pattern\":\"\"}],\"rows\":[{\"c\":[{\"v\":\"num\"},{\"v\":\"15\"},{\"v\":\"12\"},{\"v\":\"12\"}]},{\"c\":[{\"v\":\"majer\"},{\"v\":\"23\"},{\"v\":\"66\"},{\"v\":\"99\"}]},{\"c\":[{\"v\":\"gad\"},{\"v\":\"21\"},{\"v\":\"30\"},{\"v\":\"28,3\"}]},{\"c\":[{\"v\":\"roro\"},{\"v\":\"20,3\"},{\"v\":\"29,96\"},{\"v\":\"27,87\"}]}],\"p\":null}";
	
	public static void main(String[] args) {
//		Tree drevo = new Tree("doer");
//		TreeNode doer = drevo.getRoot();
//		TreeNode mama = doer.addChild("mama", 0.4);
//		TreeNode ata = doer.addChild("ata", 0.9);
//		
//		mama.addChild("neki en", 0.5);
//		TreeNode majer = mama.addChild("majer", 0.68);
//		majer.addChild("majerov ta mali");
		
//		System.out.println("Drevo: \n"+drevo);
		
		Gson gson = new Gson();
		
		DataTable dtDrevo = gson.fromJson(drevo, com.mayroro.util.DataTable.class);
		DataTable dtFunkcije = gson.fromJson(funkcije, com.mayroro.util.DataTable.class);
		DataTable dtMaut = gson.fromJson(maut, com.mayroro.util.DataTable.class);
		
		ColumnDescription cd = new ColumnDescription();
		cd.setId("G");
		cd.setLabel("num");
		cd.setType("NUMBER");
		cd.setPattern("#,##0.###############");
		
		dtFunkcije.addCol(cd);
		
		cd = new ColumnDescription();
		cd.setId("H");
		cd.setLabel("");
		cd.setType("NUMBER");
		cd.setPattern("#,##0.###############");
		
		dtFunkcije.addCol(cd);
		
		dtFunkcije.getRows().get(0).addCell("10");
		dtFunkcije.getRows().get(0).addCell("20");
		
		for (int i = 1; i<21; i++){
			dtFunkcije.getRows().get(i).addCell(Integer.toString(i));
			dtFunkcije.getRows().get(i).addCell("0.1");
		}
		
		
		dtDrevo.removeEmptyRows();
		
		System.out.println(dtFunkcije.colsToString());
		System.out.println(dtFunkcije);
		System.out.println("---------------");
		System.out.println(dtMaut);
		System.out.println("---------------");
		
		Tree drevoTree = new Tree(dtDrevo);
		System.out.println(drevoTree);
		
		drevoTree.setMautFunction(dtFunkcije);
		
		drevoTree.setData(dtMaut, 1);
		System.out.println(drevoTree);
		
		System.out.println(drevoTree.isDataComplete());
		
		
		
		StringBuilder sb = new StringBuilder();
		String result;
		for (int i = 1; i < dtMaut.getCols().size(); i++){
			drevoTree.setData(dtMaut, i);
			if (!drevoTree.isDataComplete()){
				System.out.println("CHECK DATA!");
				continue;
			}
			sb.append("~");
			sb.append(dtMaut.getCols().get(i).getLabel());
			sb.append(";");
			
			result = Double.toString(drevoTree.calculateValue()).replace('.', ',');
			sb.append(result);
//			sb.append(drevo.calculateValue());
		}
		
		System.out.println(sb.toString());
	}
}
 